<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Â≤°Â±±Ê°ÉÂ§™ÈÉé‰πãÊóÖ | Á∞°ÊΩîË°åÁ®ãÁâà</title>
    <!-- ÂºïÂÖ• React Âíå Tailwind -->
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- ÂºïÂÖ•Â≠óÈ´îËàáËá™ÂÆöÁæ©Ê®£Âºè -->
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700&family=Shippori+Mincho:wght@400;700&display=swap');
        
        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: #fcfaf8;
            color: #4a4a4a;
        }
        
        .font-serif { font-family: 'Shippori Mincho', serif; }
        .scrollbar-hide::-webkit-scrollbar { display: none; }
        .scrollbar-hide { -ms-overflow-style: none; scrollbar-width: none; }
        
        .fade-in { animation: fadeIn 0.4s ease-out forwards; opacity: 0; transform: translateY(10px); }
        @keyframes fadeIn { to { opacity: 1; transform: translateY(0); } }

        .glass-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(8px);
            border: 1px solid rgba(255, 255, 255, 0.5);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05);
            transition: all 0.2s ease;
        }
        
        .dragging {
            opacity: 0.5;
            transform: scale(0.98);
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
            border: 2px dashed #fecaca;
        }

        .edit-input {
            background: rgba(255,255,255,0.8);
            border: 1px solid #e5e7eb;
            border-radius: 6px;
            padding: 4px 8px;
            width: 100%;
            transition: all 0.2s;
        }
        .edit-input:focus {
            outline: none;
            border-color: #fecaca;
            box-shadow: 0 0 0 2px rgba(254, 202, 202, 0.3);
        }
        
        .jr-badge {
            background: #15803d;
            color: white;
            font-size: 0.65rem;
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: bold;
            letter-spacing: 0.05em;
            display: inline-flex;
            align-items: center;
            gap: 2px;
            box-shadow: 0 1px 2px rgba(0,0,0,0.1);
        }

        .cost-panel {
            background: rgba(30, 41, 59, 0.95);
            backdrop-filter: blur(10px);
            color: white;
            box-shadow: 0 -4px 20px rgba(0,0,0,0.2);
            border: 1px solid rgba(255,255,255,0.1);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
    </style>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'momo-pink': '#fecaca',
                        'momo-red': '#f43f5e',
                    }
                }
            }
        }
    </script>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef, useMemo } = React;

        // È†êË®≠Ë≥áÊñô (ÁßªÈô§ÂúñÁâáÊ¨Ñ‰Ωç)
        const defaultItineraryData = [
            {
                day: 1,
                title: "ÊäµÈÅîÂ≤°Â±±",
                subtitle: "2025/12/26 (‰∫î)",
                locations: [
                    { id: 101, time: "14:35", name: "Â≤°Â±±Ê©üÂ†¥", address: "Â≤°Â±±ÁúåÂ≤°Â±±Â∏ÇÂåóÂå∫Êó•ÂøúÂØ∫1277", type: "transport", cost: 780, jrPass: false, note: "Âà©Êú®Ê¥•Â∑¥Â£´" },
                    { id: 102, time: "16:05", name: "Â≤°Â±±ËªäÁ´ô", address: "Â≤°Â±±ÁúåÂ≤°Â±±Â∏ÇÂåóÂå∫ÈßÖÂÖÉÁî∫1-1", type: "transport", cost: 0, jrPass: false, note: "ÂÅúÁïô 00ÊôÇ15ÂàÜ" },
                    { id: 103, time: "16:30", name: "Regalo Hotel Okayama", address: "Â≤°Â±±ÁúåÂ≤°Â±±Â∏ÇÂåóÂå∫Êú¨Áî∫8-3", type: "stay", cost: 0, jrPass: false, note: "Check-in / ÂÅúÁïô 00ÊôÇ30ÂàÜ" },
                    { id: 104, time: "17:15", name: "400‚ÑÉ PIZZA „É¢„É™„Éé„Éû„ÉÅ (2Âè∑Â∫ó)", address: "Â≤°Â±±ÁúåÂ≤°Â±±Â∏ÇÂåóÂå∫Êùú„ÅÆË°ó„Ç∞„É¨„Éº„Çπ", type: "food", cost: 0, jrPass: false, note: "ÂÅúÁïô 01ÊôÇ00ÂàÜ" },
                    { id: 105, time: "18:15", name: "Myojinmaru Okayama Honmachi", address: "Â≤°Â±±ÁúåÂ≤°Â±±Â∏ÇÂåóÂå∫Êú¨Áî∫", type: "food", cost: 0, jrPass: false, note: "ÂÅúÁïô 01ÊôÇ00ÂàÜ / Âúü‰ΩêÊñôÁêÜ" },
                    { id: 106, time: "19:21", name: "Â≤°Â±±Á´ôÂâçÂïÜÂ∫óË°ó", address: "Â≤°Â±±ÁúåÂ≤°Â±±Â∏ÇÂåóÂå∫ÈßÖÂâçÁî∫", type: "activity", cost: 0, jrPass: false, note: "ÂÅúÁïô 01ÊôÇ00ÂàÜ" },
                    { id: 107, time: "20:27", name: "Don Quijote Okayama-ekimae", address: "Â≤°Â±±ÁúåÂ≤°Â±±Â∏ÇÂåóÂå∫Êú¨Áî∫6-30", type: "activity", cost: 0, jrPass: false, note: "ÂÅúÁïô 01ÊôÇ00ÂàÜ / È©öÂÆâÊÆøÂ†Ç" },
                    { id: 108, time: "21:30", name: "Yakiniku Griglia", address: "Â≤°Â±±ÁúåÂ≤°Â±±Â∏ÇÂåóÂå∫", type: "food", cost: 0, jrPass: false, note: "ÂÅúÁïô 01ÊôÇ00ÂàÜ / ÁáíËÇâ" }
                ]
            },
            {
                day: 2,
                title: "ÂÄâÊï∑ÁæéËßÄËàáÂêâÂÇôÊ¥•",
                subtitle: "2025/12/27 (ÂÖ≠)",
                locations: [
                    { id: 201, time: "08:00", name: "Â≤°Â±±ÈßÖ", address: "Â≤°Â±±ÁúåÂ≤°Â±±Â∏ÇÂåóÂå∫ÈßÖÂÖÉÁî∫1-1", type: "transport", cost: 0, jrPass: true, note: "ÂÅúÁïô 00ÊôÇ10ÂàÜ" },
                    { id: 202, time: "08:35", name: "ÂÄâÊï∑Á´ô", address: "Â≤°Â±±ÁúåÂÄâÊï∑Â∏ÇÈòøÁü•1‰∏ÅÁõÆ1-1", type: "transport", cost: 330, jrPass: true, note: "ÂÅúÁïô 00ÊôÇ05ÂàÜ" },
                    { id: 203, time: "08:48", name: "Kappa ÁÇ∏Ë±¨ÊéíÈ£Ø", address: "Â≤°Â±±ÁúåÂÄâÊï∑Â∏ÇÈòøÁü•2-17-2", type: "food", cost: 0, jrPass: false, note: "ÂÅúÁïô 01ÊôÇ00ÂàÜ" },
                    { id: 204, time: "09:50", name: "Ê¢Ö‰πãÊú®Âë≥ÂôåË±¨Êéí", address: "Â≤°Â±±ÁúåÂÄâÊï∑Â∏ÇÈòøÁü•", type: "food", cost: 0, jrPass: false, note: "ÂÅúÁïô 01ÊôÇ00ÂàÜ" },
                    { id: 205, time: "10:57", name: "ÂÄâÊï∑ÁæéËßÄÂú∞ÂçÄ", address: "Â≤°Â±±ÁúåÂÄâÊï∑Â∏Ç‰∏≠Â§Æ1-4-8", type: "activity", cost: 0, jrPass: false, note: "ÂÅúÁïô 01ÊôÇ00ÂàÜ" },
                    { id: 206, time: "12:01", name: "Kurashiki Sandwich Kitchen", address: "Â≤°Â±±ÁúåÂÄâÊï∑Â∏Ç", type: "food", cost: 0, jrPass: false, note: "ÂÅúÁïô 01ÊôÇ00ÂàÜ" },
                    { id: 207, time: "13:01", name: "ÂÄâÊï∑ÊÉ†ÊØîÂ£ΩÂïÜÂ∫óË°ó", address: "Â≤°Â±±ÁúåÂÄâÊï∑Â∏ÇÈòøÁü•", type: "activity", cost: 0, jrPass: false, note: "ÂÅúÁïô 01ÊôÇ00ÂàÜ" },
                    { id: 208, time: "14:11", name: "ÂÄâÊï∑Ê°ÉÂ≠ê Á∏ΩÊú¨Â∫ó", address: "Â≤°Â±±ÁúåÂÄâÊï∑Â∏Ç‰∏≠Â§Æ1-1-4", type: "food", cost: 0, jrPass: false, note: "ÂÅúÁïô 00ÊôÇ30ÂàÜ / ËÅñ‰ª£" },
                    { id: 209, time: "14:45", name: "Ê°ÉÂ§™ÈÉéÊ©üÈóúÂçöÁâ©È§®", address: "Â≤°Â±±ÁúåÂÄâÊï∑Â∏ÇÊú¨Áî∫5-11", type: "activity", cost: 600, jrPass: false, note: "ÂÅúÁïô 00ÊôÇ30ÂàÜ" },
                    { id: 210, time: "15:25", name: "ÈòøÊô∫Á•ûÁ§æ", address: "Â≤°Â±±ÁúåÂÄâÊï∑Â∏ÇÊú¨Áî∫12-1", type: "activity", cost: 0, jrPass: false, note: "ÂÅúÁïô 00ÊôÇ30ÂàÜ" },
                    { id: 211, time: "16:04", name: "ÂÄâÊï∑Â∏É‰∏Å", address: "Â≤°Â±±ÁúåÂÄâÊï∑Â∏ÇÊú¨Áî∫", type: "food", cost: 0, jrPass: false, note: "ÂÅúÁïô 00ÊôÇ05ÂàÜ" },
                    { id: 212, time: "16:09", name: "Â≤°Â±±ËªäÁ´ô", address: "Â≤°Â±±ÁúåÂ≤°Â±±Â∏ÇÂåóÂå∫ÈßÖÂÖÉÁî∫1-1", type: "transport", cost: 330, jrPass: true, note: "ÂÅúÁïô 00ÊôÇ10ÂàÜ" },
                    { id: 213, time: "16:40", name: "ÂÇôÂâç‰∏ÄÂÆÆ", address: "Â≤°Â±±ÁúåÂ≤°Â±±Â∏ÇÂåóÂå∫‰∏ÄÂÆÆ", type: "transport", cost: 210, jrPass: true, note: "ÂÅúÁïô 00ÊôÇ05ÂàÜ" },
                    { id: 214, time: "17:12", name: "ÂêâÂÇôÊ¥•Á•ûÁ§æ", address: "Â≤°Â±±ÁúåÂ≤°Â±±Â∏ÇÂåóÂå∫ÂêâÂÇôÊ¥•931", type: "activity", cost: 0, jrPass: false, note: "ÂÅúÁïô 01ÊôÇ00ÂàÜ" },
                    { id: 215, time: "18:30", name: "Èö†Â≤êÂ≥∂ÊãâÈ∫∫", address: "Â≤°Â±±ÁúåÂ≤°Â±±Â∏ÇÂåóÂå∫Êú¨Áî∫", type: "food", cost: 0, jrPass: false, note: "ÂÅúÁïô 01ÊôÇ00ÂàÜ" },
                    { id: 216, time: "19:37", name: "Tan-ya Bizen (Aeon Mall)", address: "Â≤°Â±±ÁúåÂ≤°Â±±Â∏ÇÂåóÂå∫‰∏ãÁü≥‰∫ï1-2-1", type: "food", cost: 0, jrPass: false, note: "ÂÅúÁïô 01ÊôÇ00ÂàÜ" },
                    { id: 217, time: "20:46", name: "Regalo Hotel Okayama", address: "Â≤°Â±±ÁúåÂ≤°Â±±Â∏ÇÂåóÂå∫Êú¨Áî∫8-3", type: "stay", cost: 0, jrPass: false, note: "ÂÅúÁïô 01ÊôÇ00ÂàÜ" },
                    { id: 218, time: "21:46", name: "Shabu-shabu Sukiyaki Hitorinabe Megu", address: "Â≤°Â±±ÁúåÂ≤°Â±±Â∏ÇÂåóÂå∫", type: "food", cost: 0, jrPass: false, note: "ÂÅúÁïô 01ÊôÇ00ÂàÜ" }
                ]
            },
            {
                day: 3,
                title: "Áõ¥Â≥∂ËóùË°ìÂ∑°Á¶Æ",
                subtitle: "2025/12/28 (Êó•)",
                locations: [
                    { id: 301, time: "08:00", name: "Â≤°Â±±ËªäÁ´ô", address: "Â≤°Â±±ÁúåÂ≤°Â±±Â∏ÇÂåóÂå∫ÈßÖÂÖÉÁî∫1-1", type: "transport", cost: 0, jrPass: true, note: "ÂÅúÁïô 00ÊôÇ10ÂàÜ" },
                    { id: 302, time: "09:04", name: "ÂÆáÈáéËªäÁ´ô", address: "Â≤°Â±±ÁúåÁéâÈáéÂ∏ÇÁØâÊ∏Ø1-1", type: "transport", cost: 590, jrPass: true, note: "ÂÅúÁïô 00ÊôÇ10ÂàÜ" },
                    { id: 303, time: "09:20", name: "ÂæÄÁõ¥Â≥∂Ê∏°Ëº™‰πòËàπËôï", address: "Â≤°Â±±ÁúåÁéâÈáéÂ∏ÇÁØâÊ∏Ø", type: "transport", cost: 300, jrPass: false, note: "ÂÅúÁïô 00ÊôÇ15ÂàÜ" },
                    { id: 304, time: "10:05", name: "Ougiya Rent-a-Cycle", address: "È¶ôÂ∑ùÁúåÈ¶ôÂ∑ùÈÉ°Áõ¥Â≥∂Áî∫ÂÆÆ„ÉéÊµ¶", type: "activity", cost: 0, jrPass: false, note: "ÂÅúÁïô 00ÊôÇ20ÂàÜ / ÁßüËªä" },
                    { id: 305, time: "10:47", name: "ËçâÈñìÂΩåÁîü„ÄåËµ§ÂçóÁìú„Äç", address: "È¶ôÂ∑ùÁúåÈ¶ôÂ∑ùÈÉ°Áõ¥Â≥∂Áî∫ÂÆÆ„ÉéÊµ¶Ê∏Ø", type: "activity", cost: 0, jrPass: false, note: "ÂÅúÁïô 00ÊôÇ30ÂàÜ" },
                    { id: 306, time: "11:17", name: "Cafe Salon ‰∏≠Â••", address: "È¶ôÂ∑ùÁúåÈ¶ôÂ∑ùÈÉ°Áõ¥Â≥∂Áî∫Êú¨Êùë", type: "food", cost: 0, jrPass: false, note: "ÂÅúÁïô 01ÊôÇ00ÂàÜ" },
                    { id: 307, time: "12:23", name: "maimaiÔºàÂÖÉÁ•ñ Áõ¥Â≥∂„Éê„Éº„Ç¨„ÉºÔºâ", address: "È¶ôÂ∑ùÁúåÈ¶ôÂ∑ùÈÉ°Áõ¥Â≥∂Áî∫Êú¨Êùë", type: "food", cost: 0, jrPass: false, note: "ÂÅúÁïô 01ÊôÇ00ÂàÜ" },
                    { id: 308, time: "13:44", name: "naoshima gelato (Áõ¥Â≥∂„Ç∏„Çß„É©„Éº„Éà)", address: "È¶ôÂ∑ùÁúåÈ¶ôÂ∑ùÈÉ°Áõ¥Â≥∂Áî∫", type: "food", cost: 0, jrPass: false, note: "ÂÅúÁïô 00ÊôÇ10ÂàÜ" },
                    { id: 309, time: "13:54", name: "Áõ¥Â≥∂„Éå„Éº„Éâ„É´", address: "È¶ôÂ∑ùÁúåÈ¶ôÂ∑ùÈÉ°Áõ¥Â≥∂Áî∫", type: "food", cost: 0, jrPass: false, note: "ÂÅúÁïô 01ÊôÇ00ÂàÜ" },
                    { id: 310, time: "15:01", name: "Naoshima Yokocho", address: "È¶ôÂ∑ùÁúåÈ¶ôÂ∑ùÈÉ°Áõ¥Â≥∂Áî∫", type: "food", cost: 0, jrPass: false, note: "ÂÅúÁïô 01ÊôÇ00ÂàÜ" },
                    { id: 311, time: "16:07", name: "Kinosaki Udon Naoshima", address: "È¶ôÂ∑ùÁúåÈ¶ôÂ∑ùÈÉ°Áõ¥Â≥∂Áî∫", type: "food", cost: 0, jrPass: false, note: "ÂÅúÁïô 01ÊôÇ00ÂàÜ" },
                    { id: 312, time: "17:07", name: "ÂÆáÈáéÊ∏Ø", address: "Â≤°Â±±ÁúåÁéâÈáéÂ∏ÇÁØâÊ∏Ø", type: "transport", cost: 300, jrPass: false, note: "ÂÅúÁïô 00ÊôÇ10ÂàÜ / ÂõûÁ®ãÊ∏°Ëº™" },
                    { id: 313, time: "17:38", name: "ÂÆáÈáéËªäÁ´ô", address: "Â≤°Â±±ÁúåÁéâÈáéÂ∏ÇÁØâÊ∏Ø1-1", type: "transport", cost: 0, jrPass: true, note: "ÂÅúÁïô 00ÊôÇ10ÂàÜ" },
                    { id: 314, time: "17:54", name: "Setouchi Onsen Tamanoyu", address: "Â≤°Â±±ÁúåÁéâÈáéÂ∏ÇÁØâÊ∏Ø1-1-11", type: "relax", cost: 0, jrPass: false, note: "ÂÅúÁïô 01ÊôÇ00ÂàÜ / Ê∫´Ê≥â" },
                    { id: 315, time: "19:00", name: "ÂÆáÈáéËªäÁ´ô", address: "Â≤°Â±±ÁúåÁéâÈáéÂ∏ÇÁØâÊ∏Ø1-1", type: "transport", cost: 590, jrPass: true, note: "ÂÅúÁïô 01ÊôÇ00ÂàÜ" },
                    { id: 316, time: "20:54", name: "Â≤°Â±±ËªäÁ´ô", address: "Â≤°Â±±ÁúåÂ≤°Â±±Â∏ÇÂåóÂå∫ÈßÖÂÖÉÁî∫1-1", type: "transport", cost: 0, jrPass: true, note: "ÂÅúÁïô 00ÊôÇ10ÂàÜ" },
                    { id: 317, time: "21:14", name: "Regalo Hotel Okayama", address: "Â≤°Â±±ÁúåÂ≤°Â±±Â∏ÇÂåóÂå∫Êú¨Áî∫8-3", type: "stay", cost: 0, jrPass: false, note: "ÂÅúÁïô 01ÊôÇ00ÂàÜ" }
                ]
            },
            {
                day: 4,
                title: "ÂÖîÂ≥∂ËàáÂª£Â≥∂",
                subtitle: "2025/12/29 (‰∏Ä)",
                locations: [
                    { id: 401, time: "08:00", name: "Â≤°Â±±ËªäÁ´ô", address: "Â≤°Â±±ÁúåÂ≤°Â±±Â∏ÇÂåóÂå∫ÈßÖÂÖÉÁî∫1-1", type: "transport", cost: 0, jrPass: true, note: "ÂÅúÁïô 00ÊôÇ10ÂàÜ" },
                    { id: 402, time: "08:56", name: "Âª£Â≥∂", address: "Â∫ÉÂ≥∂ÁúåÂ∫ÉÂ≥∂Â∏ÇÂçóÂå∫ÊùæÂéüÁî∫2-37", type: "transport", cost: 6230, jrPass: true, note: "ÂÅúÁïô 00ÊôÇ10ÂàÜ / Êñ∞ÂππÁ∑ö" },
                    { id: 403, time: "10:02", name: "Âø†Êµ∑Á´ô", address: "Â∫ÉÂ≥∂ÁúåÁ´πÂéüÂ∏ÇÂø†Êµ∑‰∏≠Áî∫1-1", type: "transport", cost: 1490, jrPass: true, note: "ÂÅúÁïô 00ÊôÇ10ÂàÜ" },
                    { id: 404, time: "10:18", name: "Âø†Êµ∑Ê∏Ø Ê∏°Ëº™‰πòËàπËôï", address: "Â∫ÉÂ≥∂ÁúåÁ´πÂéüÂ∏ÇÂø†Êµ∑", type: "transport", cost: 370, jrPass: false, note: "ÂÅúÁïô 00ÊôÇ10ÂàÜ" },
                    { id: 405, time: "11:00", name: "ÂÖîËÄ≥ÈõÜÈü≥Âô®", address: "Â§ß‰πÖÈáéÂ≥∂", type: "activity", cost: 0, jrPass: false, note: "ÂÅúÁïô 00ÊôÇ40ÂàÜ" },
                    { id: 406, time: "11:46", name: "ÂÖî‰∫∫ÂíñÂï°", address: "Â§ß‰πÖÈáéÂ≥∂‰ºëÊöáÊùë", type: "food", cost: 0, jrPass: false, note: "ÂÅúÁïô 01ÊôÇ00ÂàÜ" },
                    { id: 407, time: "13:21", name: "Âø†Êµ∑Ê∏Ø Ê∏°Ëº™‰πòËàπËôï", address: "Â∫ÉÂ≥∂ÁúåÁ´πÂéüÂ∏ÇÂø†Êµ∑", type: "transport", cost: 370, jrPass: false, note: "ÂÅúÁïô 00ÊôÇ10ÂàÜ" },
                    { id: 408, time: "14:26", name: "Âª£Â≥∂", address: "Â∫ÉÂ≥∂ÁúåÂ∫ÉÂ≥∂Â∏ÇÂçóÂå∫ÊùæÂéüÁî∫", type: "transport", cost: 1490, jrPass: true, note: "ÂÅúÁïô 00ÊôÇ10ÂàÜ" },
                    { id: 409, time: "14:49", name: "Âª£Â≥∂Âüé", address: "Â∫ÉÂ≥∂ÁúåÂ∫ÉÂ≥∂Â∏Ç‰∏≠Âå∫Âü∫Áî∫21-1", type: "activity", cost: 370, jrPass: false, note: "ÂÅúÁïô 01ÊôÇ00ÂàÜ" },
                    { id: 410, time: "16:01", name: "ÂéüÂ≠êÂΩàÁàÜÁÇ∏ÂúìÈ†ÇÂ±ã", address: "Â∫ÉÂ≥∂ÁúåÂ∫ÉÂ≥∂Â∏Ç‰∏≠Âå∫Â§ßÊâãÁî∫1-10", type: "activity", cost: 0, jrPass: false, note: "ÂÅúÁïô 01ÊôÇ00ÂàÜ" },
                    { id: 411, time: "17:08", name: "Êú¨ÈÄöÂïÜÂ∫óË°ó", address: "Â∫ÉÂ≥∂ÁúåÂ∫ÉÂ≥∂Â∏Ç‰∏≠Âå∫Êú¨ÈÄö", type: "activity", cost: 0, jrPass: false, note: "ÂÅúÁïô 01ÊôÇ00ÂàÜ" },
                    { id: 412, time: "18:42", name: "ORIGAMINN", address: "Â∫ÉÂ≥∂ÁúåÂ∫ÉÂ≥∂Â∏Ç", type: "stay", cost: 0, jrPass: false, note: "Check-in / ÂÅúÁïô 01ÊôÇ00ÂàÜ" },
                    { id: 413, time: "20:10", name: "Nagataya („ÅäÂ•Ω„ÅøÁÑº Èï∑Áî∞Â±ã)", address: "Â∫ÉÂ≥∂ÁúåÂ∫ÉÂ≥∂Â∏Ç‰∏≠Âå∫Â§ßÊâãÁî∫1-7-19", type: "food", cost: 0, jrPass: false, note: "ÂÅúÁïô 01ÊôÇ00ÂàÜ / Âª£Â≥∂Ááí" },
                    { id: 414, time: "21:22", name: "Âª£Â≥∂PARCO Êú¨È§®", address: "Â∫ÉÂ≥∂ÁúåÂ∫ÉÂ≥∂Â∏Ç‰∏≠Âå∫Êú¨ÈÄö10-1", type: "activity", cost: 0, jrPass: false, note: "ÂÅúÁïô 01ÊôÇ00ÂàÜ" },
                    { id: 415, time: "22:24", name: "Okonomimura", address: "Â∫ÉÂ≥∂ÁúåÂ∫ÉÂ≥∂Â∏Ç‰∏≠Âå∫Êñ∞Â§©Âú∞5-13", type: "food", cost: 0, jrPass: false, note: "ÂÅúÁïô 01ÊôÇ00ÂàÜ" },
                    { id: 416, time: "23:27", name: "È©öÂÆâÊÆøÂ†Ç ÂîêÂêâËªªÂæ∑", address: "Â∫ÉÂ≥∂ÁúåÂ∫ÉÂ≥∂Â∏Ç‰∏≠Âå∫Êñ∞Â§©Âú∞5-3", type: "activity", cost: 0, jrPass: false, note: "ÂÅúÁïô 01ÊôÇ00ÂàÜ" },
                    { id: 417, time: "00:58", name: "ORIGAMINN", address: "Â∫ÉÂ≥∂ÁúåÂ∫ÉÂ≥∂Â∏Ç", type: "stay", cost: 0, jrPass: false, note: "ÂÅúÁïô 01ÊôÇ00ÂàÜ" }
                ]
            },
            {
                day: 5,
                title: "Â∞æÈÅìËàáÈûÜ‰πãÊµ¶",
                subtitle: "2025/12/30 (‰∫å)",
                locations: [
                    { id: 501, time: "08:00", name: "Âª£Â≥∂", address: "Â∫ÉÂ≥∂ÁúåÂ∫ÉÂ≥∂Â∏ÇÂçóÂå∫ÊùæÂéüÁî∫", type: "transport", cost: 0, jrPass: true, note: "ÂÅúÁïô 00ÊôÇ10ÂàÜ" },
                    { id: 502, time: "09:02", name: "Â∞æÈÅì", address: "Â∫ÉÂ≥∂ÁúåÂ∞æÈÅìÂ∏ÇÊù±Âæ°ÊâÄÁî∫1-1", type: "transport", cost: 1500, jrPass: true, note: "ÂÅúÁïô 00ÊôÇ10ÂàÜ" },
                    { id: 503, time: "09:39", name: "ÂçÉÂÖâÂØ∫Â±±Á∫úËªä Â±±È∫ìÁ´ô", address: "Â∫ÉÂ≥∂ÁúåÂ∞æÈÅìÂ∏ÇÊù±ÂúüÂ†ÇÁî∫20-1", type: "transport", cost: 500, jrPass: false, note: "ÂÅúÁïô 00ÊôÇ10ÂàÜ" },
                    { id: 504, time: "10:07", name: "ÂçÉÂÖâÂØ∫ÂÖ¨ÂúíÈ†Ç‰∏äÂ±ïÊúõÂè∞", address: "Â∫ÉÂ≥∂ÁúåÂ∞æÈÅìÂ∏ÇÊù±ÂúüÂ†ÇÁî∫15-1", type: "activity", cost: 0, jrPass: false, note: "ÂÅúÁïô 00ÊôÇ20ÂàÜ" },
                    { id: 505, time: "10:32", name: "ÈºìÂ≤©", address: "Â∫ÉÂ≥∂ÁúåÂ∞æÈÅìÂ∏ÇÊù±ÂúüÂ†ÇÁî∫", type: "activity", cost: 0, jrPass: false, note: "ÂÅúÁïô 00ÊôÇ20ÂàÜ" },
                    { id: 506, time: "11:12", name: "Â∞æÈÅìÊãâÈ∫µ Â£πÁï™È§®Êú¨Â∫ó", address: "Â∫ÉÂ≥∂ÁúåÂ∞æÈÅìÂ∏ÇÂúüÂ†Ç2-9-26", type: "food", cost: 0, jrPass: false, note: "ÂÅúÁïô 01ÊôÇ00ÂàÜ" },
                    { id: 507, time: "12:15", name: "ÔºàÊúâÔºâÈáëËê¨Â†ÇÊú¨Ëàó Êú¨Â∫ó", address: "Â∫ÉÂ≥∂ÁúåÂ∞æÈÅìÂ∏ÇÂúüÂ†Ç", type: "food", cost: 0, jrPass: false, note: "ÂÅúÁïô 01ÊôÇ00ÂàÜ" },
                    { id: 508, time: "13:24", name: "Nekonotepan factory", address: "Â∫ÉÂ≥∂ÁúåÂ∞æÈÅìÂ∏ÇÊù±ÂúüÂ†ÇÁî∫", type: "food", cost: 0, jrPass: false, note: "ÂÅúÁïô 00ÊôÇ10ÂàÜ" },
                    { id: 509, time: "13:44", name: "Â∞èÈáéË≤ìÈªûÂøÉÈã™", address: "Â∫ÉÂ≥∂ÁúåÂ∞æÈÅìÂ∏ÇÊù±ÂúüÂ†ÇÁî∫", type: "food", cost: 0, jrPass: false, note: "ÂÅúÁïô 00ÊôÇ10ÂàÜ" },
                    { id: 510, time: "13:55", name: "Onomichi Sakurachaya Ekimae", address: "Â∫ÉÂ≥∂ÁúåÂ∞æÈÅìÂ∏Ç", type: "food", cost: 0, jrPass: false, note: "ÂÅúÁïô 01ÊôÇ00ÂàÜ" },
                    { id: 511, time: "14:57", name: "Â∞æÈÅìÊú¨ÈÄöÂïÜÂ∫óË°ó", address: "Â∫ÉÂ≥∂ÁúåÂ∞æÈÅìÂ∏ÇÂúüÂ†Ç", type: "activity", cost: 0, jrPass: false, note: "ÂÅúÁïô 01ÊôÇ00ÂàÜ" },
                    { id: 512, time: "16:12", name: "Â∞æÈÅì", address: "Â∫ÉÂ≥∂ÁúåÂ∞æÈÅìÂ∏Ç", type: "transport", cost: 0, jrPass: true, note: "ÂÅúÁïô 00ÊôÇ05ÂàÜ" },
                    { id: 513, time: "16:21", name: "Â∞æÈÅìÊãâÈ∫µ „Éô„ÉÉ„ÉÅ„É£„Éº", address: "Â∫ÉÂ≥∂ÁúåÂ∞æÈÅìÂ∏Ç", type: "food", cost: 0, jrPass: false, note: "ÂÅúÁïô 01ÊôÇ00ÂàÜ" },
                    { id: 514, time: "17:27", name: "Karasawa Ice Cream", address: "Â∫ÉÂ≥∂ÁúåÂ∞æÈÅìÂ∏ÇÂúüÂ†Ç1-15-19", type: "food", cost: 0, jrPass: false, note: "ÂÅúÁïô 01ÊôÇ00ÂàÜ" },
                    { id: 515, time: "19:12", name: "Á¶èÂ±±ËªäÁ´ô", address: "Â∫ÉÂ≥∂ÁúåÁ¶èÂ±±Â∏Ç‰∏â‰πã‰∏∏Áî∫30-1", type: "transport", cost: 420, jrPass: true, note: "ÂÅúÁïô 00ÊôÇ05ÂàÜ" },
                    { id: 516, time: "19:52", name: "ÈûÜ‰πãÊµ¶ËßÄÂÖâÊÉÖÂ†±‰∏≠ÂøÉ", address: "Â∫ÉÂ≥∂ÁúåÁ¶èÂ±±Â∏ÇÈûÜÁî∫ÈûÜ", type: "activity", cost: 550, jrPass: false, note: "ÂÅúÁïô 00ÊôÇ10ÂàÜ" },
                    { id: 517, time: "20:10", name: "Ê±ê‰πãÈü≥ ÈûÜ‰πãÊµ¶Â§ßÁ¶è", address: "Â∫ÉÂ≥∂ÁúåÁ¶èÂ±±Â∏ÇÈûÜÁî∫", type: "food", cost: 0, jrPass: false, note: "ÂÅúÁïô 00ÊôÇ10ÂàÜ" },
                    { id: 518, time: "20:31", name: "Yuki-san-chi", address: "Â∫ÉÂ≥∂ÁúåÁ¶èÂ±±Â∏ÇÈûÜÁî∫", type: "food", cost: 0, jrPass: false, note: "ÂÅúÁïô 01ÊôÇ00ÂàÜ" },
                    { id: 519, time: "21:41", name: "Cafe Gangi", address: "Â∫ÉÂ≥∂ÁúåÁ¶èÂ±±Â∏ÇÈûÜÁî∫", type: "food", cost: 0, jrPass: false, note: "ÂÅúÁïô 01ÊôÇ00ÂàÜ" },
                    { id: 520, time: "22:43", name: "Tomonoura a cafe", address: "Â∫ÉÂ≥∂ÁúåÁ¶èÂ±±Â∏ÇÈûÜÁî∫", type: "food", cost: 0, jrPass: false, note: "ÂÅúÁïô 01ÊôÇ00ÂàÜ" },
                    { id: 521, time: "23:43", name: "ORIGAMINN", address: "Â∫ÉÂ≥∂ÁúåÂ∫ÉÂ≥∂Â∏Ç", type: "stay", cost: 0, jrPass: false, note: "ÂÅúÁïô 01ÊôÇ00ÂàÜ" }
                ]
            },
            {
                day: 6,
                title: "ÂÆÆÂ≥∂Âö¥Â≥∂Á•ûÁ§æ",
                subtitle: "2025/12/31 (‰∏â)",
                locations: [
                    { id: 601, time: "08:00", name: "Âª£Â≥∂", address: "Â∫ÉÂ≥∂ÁúåÂ∫ÉÂ≥∂Â∏ÇÂçóÂå∫ÊùæÂéüÁî∫", type: "transport", cost: 0, jrPass: true, note: "ÂÅúÁïô 00ÊôÇ10ÂàÜ" },
                    { id: 602, time: "08:49", name: "ÂÆÆÂ≥∂Âè£", address: "Â∫ÉÂ≥∂ÁúåÂªøÊó•Â∏ÇÂ∏ÇÂÆÆÂ≥∂Âè£", type: "transport", cost: 420, jrPass: true, note: "ÂÅúÁïô 00ÊôÇ10ÂàÜ" },
                    { id: 603, time: "09:02", name: "JR Ë•øÊó•Êú¨ÂÆÆÂ≥∂Ê∏°Ëº™ Ê£ßÊ©ã‰∫ãÂãôÊâÄ", address: "Â∫ÉÂ≥∂ÁúåÂªøÊó•Â∏ÇÂ∏ÇÂÆÆÂ≥∂Âè£", type: "transport", cost: 180, jrPass: true, note: "ÂÅúÁïô 00ÊôÇ10ÂàÜ" },
                    { id: 604, time: "09:55", name: "ÂÆÆÂ≥∂Á∫úËªä", address: "Â∫ÉÂ≥∂ÁúåÂªøÊó•Â∏ÇÂ∏ÇÂÆÆÂ≥∂Áî∫", type: "transport", cost: 1100, jrPass: false, note: "ÂÅúÁïô 01ÊôÇ00ÂàÜ" },
                    { id: 605, time: "11:30", name: "ÂΩåÂ±± Â±ïÊúõÂè∞", address: "Â∫ÉÂ≥∂ÁúåÂªøÊó•Â∏ÇÂ∏ÇÂÆÆÂ≥∂Áî∫", type: "activity", cost: 0, jrPass: false, note: "ÂÅúÁïô 01ÊôÇ00ÂàÜ" },
                    { id: 606, time: "13:12", name: "Âö¥Â≥∂Á•ûÁ§æ", address: "Â∫ÉÂ≥∂ÁúåÂªøÊó•Â∏ÇÂ∏ÇÂÆÆÂ≥∂Áî∫1-1", type: "activity", cost: 300, jrPass: false, note: "ÂÅúÁïô 01ÊôÇ00ÂàÜ" },
                    { id: 607, time: "14:23", name: "ÂÆÆÂ≥∂ÂíñÂñ±È∫µÂåÖÁ†îÁ©∂ÊâÄ", address: "Â∫ÉÂ≥∂ÁúåÂªøÊó•Â∏ÇÂ∏ÇÂÆÆÂ≥∂Áî∫", type: "food", cost: 0, jrPass: false, note: "ÂÅúÁïô 00ÊôÇ10ÂàÜ" },
                    { id: 608, time: "14:36", name: "ÂÆÆÂ≥∂Ë°®ÂèÉÈÅìÂïÜÂ∫óË°ó", address: "Â∫ÉÂ≥∂ÁúåÂªøÊó•Â∏ÇÂ∏ÇÂÆÆÂ≥∂Áî∫", type: "activity", cost: 0, jrPass: false, note: "ÂÅúÁïô 01ÊôÇ00ÂàÜ" },
                    { id: 609, time: "15:38", name: "Miyajima Oyster Fried Skewers", address: "Â∫ÉÂ≥∂ÁúåÂªøÊó•Â∏ÇÂ∏ÇÂÆÆÂ≥∂Áî∫", type: "food", cost: 0, jrPass: false, note: "ÂÅúÁïô 00ÊôÇ10ÂàÜ" },
                    { id: 610, time: "15:50", name: "ÂÆÆÂ≥∂ÂíñÂï°", address: "Â∫ÉÂ≥∂ÁúåÂªøÊó•Â∏ÇÂ∏ÇÂÆÆÂ≥∂Áî∫", type: "food", cost: 0, jrPass: false, note: "ÂÅúÁïô 00ÊôÇ20ÂàÜ" },
                    { id: 611, time: "16:11", name: "ÁÇ∏ÈªëËº™ ‰∏âÈÅäÂß¨", address: "Â∫ÉÂ≥∂ÁúåÂªøÊó•Â∏ÇÂ∏ÇÂÆÆÂ≥∂Áî∫", type: "food", cost: 0, jrPass: false, note: "ÂÅúÁïô 00ÊôÇ10ÂàÜ" },
                    { id: 612, time: "16:22", name: "ÁÇ∏Á¥ÖËëâÈ•ÖÈ†≠ Á¥ÖËëâÂ†ÇÊú¨Â∫ó", address: "Â∫ÉÂ≥∂ÁúåÂªøÊó•Â∏ÇÂ∏ÇÂÆÆÂ≥∂Áî∫", type: "food", cost: 0, jrPass: false, note: "ÂÅúÁïô 00ÊôÇ10ÂàÜ" },
                    { id: 613, time: "16:41", name: "Â±±ÊùëËå∂Â±ã", address: "Â∫ÉÂ≥∂ÁúåÂªøÊó•Â∏ÇÂ∏ÇÂÆÆÂ≥∂Áî∫", type: "food", cost: 0, jrPass: false, note: "ÂÅúÁïô 01ÊôÇ00ÂàÜ" },
                    { id: 614, time: "19:16", name: "ORIGAMINN", address: "Â∫ÉÂ≥∂ÁúåÂ∫ÉÂ≥∂Â∏Ç", type: "stay", cost: 0, jrPass: false, note: "ÂÅúÁïô 01ÊôÇ00ÂàÜ" }
                ]
            },
            {
                day: 7,
                title: "Â≤°Â±±ÂüéËàáË≥¶Ê≠∏",
                subtitle: "2026/01/01 (Âõõ)",
                locations: [
                    { id: 701, time: "08:00", name: "ORIGAMINN", address: "Â∫ÉÂ≥∂ÁúåÂ∫ÉÂ≥∂Â∏Ç", type: "stay", cost: 0, jrPass: false, note: "ÂÅúÁïô 01ÊôÇ00ÂàÜ" },
                    { id: 702, time: "10:20", name: "Â≤°Â±±ËªäÁ´ô", address: "Â≤°Â±±ÁúåÂ≤°Â±±Â∏ÇÂåóÂå∫ÈßÖÂÖÉÁî∫1-1", type: "transport", cost: 6230, jrPass: true, note: "ÂÅúÁïô 01ÊôÇ00ÂàÜ" },
                    { id: 703, time: "11:29", name: "Yakinikuhidaya Honmachiten", address: "Â≤°Â±±ÁúåÂ≤°Â±±Â∏ÇÂåóÂå∫Êú¨Áî∫", type: "food", cost: 0, jrPass: false, note: "ÂÅúÁïô 01ÊôÇ00ÂàÜ / ÁáíËÇâ" },
                    { id: 704, time: "12:34", name: "Âë≥Âè∏ ÈáéÊùë", address: "Â≤°Â±±ÁúåÂ≤°Â±±Â∏ÇÂåóÂå∫Âπ≥ÂíåÁî∫1-10", type: "food", cost: 0, jrPass: false, note: "ÂÅúÁïô 01ÊôÇ00ÂàÜ" },
                    { id: 705, time: "13:50", name: "Â≤°Â±±ÂæåÊ®ÇÂúí", address: "Â≤°Â±±ÁúåÂ≤°Â±±Â∏ÇÂåóÂå∫ÂæåÊ•ΩÂúí1-5", type: "activity", cost: 400, jrPass: false, note: "ÂÅúÁïô 01ÊôÇ00ÂàÜ" },
                    { id: 706, time: "14:57", name: "Â≤°Â±±Âüé", address: "Â≤°Â±±ÁúåÂ≤°Â±±Â∏ÇÂåóÂå∫‰∏∏„ÅÆÂÜÖ2-3-1", type: "activity", cost: 0, jrPass: false, note: "ÂÅúÁïô 01ÊôÇ00ÂàÜ" },
                    { id: 707, time: "15:57", name: "Â≤°Â±±Ê©üÂ†¥", address: "Â≤°Â±±ÁúåÂ≤°Â±±Â∏ÇÂåóÂå∫Êó•ÂøúÂØ∫1277", type: "transport", cost: 780, jrPass: false, note: "ÂÅúÁïô 01ÊôÇ00ÂàÜ" },
                    { id: 708, time: "16:57", name: "Ê°ÉÂúíÂúãÈöõÊ©üÂ†¥Á¨¨‰∫åËà™Âªà", address: "Âè∞ÁÅ£Ê°ÉÂúíÂ∏ÇÂ§ßÂúíÂçÄ", type: "transport", cost: 0, jrPass: false, note: "ÂÅúÁïô 01ÊôÇ00ÂàÜ" }
                ]
            }
        ];

        // ÂúñÁ§∫ÁµÑ‰ª∂
        const Icon = ({ type }) => {
            const icons = { transport: "üöÑ", food: "üçú", activity: "‚õ©Ô∏è", stay: "üõèÔ∏è", relax: "‚ô®Ô∏è" };
            const colors = {
                transport: "bg-gray-100 text-gray-600",
                food: "bg-orange-100 text-orange-500",
                activity: "bg-momo-pink text-momo-red",
                stay: "bg-indigo-100 text-indigo-500",
                relax: "bg-teal-100 text-teal-600"
            };
            return (
                <div className={`w-10 h-10 rounded-full flex items-center justify-center text-xl shrink-0 ${colors[type] || colors.activity} shadow-sm border border-white/50 bg-white`}>
                    {icons[type] || icons.activity}
                </div>
            );
        };

        // Ë°åÁ®ãÂç°Áâá
        const LocationCard = ({ 
            item, index, onUpdate, onDelete, onDuplicate, isLast,
            onDragStart, onDragEnter, onDragEnd 
        }) => {
            const [isEditing, setIsEditing] = useState(false);
            const [editData, setEditData] = useState({ ...item });

            const handleSave = () => {
                const finalData = { ...editData, cost: parseInt(editData.cost) || 0 };
                onUpdate(index, finalData);
                setIsEditing(false);
            };

            const handleChange = (e) => {
                const { name, value, type, checked } = e.target;
                setEditData(prev => ({ 
                    ...prev, 
                    [name]: type === 'checkbox' ? checked : value 
                }));
            };

            if (isEditing) {
                return (
                    <div className="relative pl-14 mb-4 fade-in z-20">
                        <div className="absolute left-0 top-0 w-10 flex justify-center">
                             <div className="z-10 bg-fcfaf8 p-1"><Icon type={editData.type} /></div>
                        </div>
                        <div className="glass-card p-4 rounded-xl border-l-4 border-l-stone-400 bg-white shadow-xl">
                            <div className="grid grid-cols-2 gap-2 mb-3">
                                <input name="time" value={editData.time} onChange={handleChange} placeholder="ÊôÇÈñì" className="edit-input text-xs font-bold" />
                                <select name="type" value={editData.type} onChange={handleChange} className="edit-input text-xs">
                                    <option value="transport">üöÑ ‰∫§ÈÄö</option>
                                    <option value="food">üçú ÁæéÈ£ü</option>
                                    <option value="activity">‚õ©Ô∏è ÊôØÈªû</option>
                                    <option value="stay">üõèÔ∏è ‰ΩèÂÆø</option>
                                    <option value="relax">‚ô®Ô∏è ÊîæÈ¨Ü</option>
                                </select>
                            </div>
                            <input name="name" value={editData.name} onChange={handleChange} placeholder="Âú∞ÈªûÂêçÁ®±" className="edit-input font-bold text-lg mb-2" autoFocus />
                            
                            {/* Âú∞ÂùÄÁ∑®ËºØÊ¨Ñ‰Ωç */}
                            <div className="mb-2">
                                <label className="text-[10px] text-gray-400 block mb-1">üìç Ë©≥Á¥∞Âú∞ÂùÄ</label>
                                <input name="address" value={editData.address || ''} onChange={handleChange} placeholder="Ëº∏ÂÖ•Âú∞ÂùÄ..." className="edit-input text-xs text-stone-600" />
                            </div>

                            <div className="grid grid-cols-2 gap-2 mb-2 bg-gray-50 p-2 rounded-lg">
                                <div className="relative">
                                    <span className="absolute left-2 top-1.5 text-gray-400 text-xs">¬•</span>
                                    <input name="cost" type="number" value={editData.cost} onChange={handleChange} placeholder="0" className="edit-input pl-5 text-sm font-mono" />
                                </div>
                                <div className="flex items-center">
                                    <label className="flex items-center space-x-2 text-sm text-gray-600 cursor-pointer select-none">
                                        <input type="checkbox" name="jrPass" checked={editData.jrPass} onChange={handleChange} className="w-4 h-4 text-green-600 rounded focus:ring-green-500 border-gray-300" />
                                        <span>JR Pass ÈÅ©Áî®</span>
                                    </label>
                                </div>
                            </div>
                            
                            <input name="note" value={editData.note} onChange={handleChange} placeholder="ÂÇôË®ª" className="edit-input text-sm mt-1" />
                            
                            <div className="flex justify-end gap-2 mt-3 pt-2 border-t border-gray-100">
                                <button onClick={() => setIsEditing(false)} className="px-3 py-1 text-xs text-gray-500 hover:bg-gray-100 rounded">ÂèñÊ∂à</button>
                                <button onClick={handleSave} className="px-4 py-1 bg-stone-800 text-white text-xs rounded hover:bg-black">ÂÑ≤Â≠ò</button>
                            </div>
                        </div>
                    </div>
                );
            }

            return (
                <div 
                    draggable
                    onDragStart={(e) => onDragStart(e, index)}
                    onDragEnter={(e) => onDragEnter(e, index)}
                    onDragEnd={onDragEnd}
                    onDragOver={(e) => e.preventDefault()}
                    className="relative pl-14 group cursor-move transition-transform duration-200"
                    style={{ animationDelay: `${index * 50}ms` }}
                >
                    {!isLast && <div className="absolute left-5 top-10 bottom-0 w-0.5 bg-stone-200 pointer-events-none"></div>}
                    <div className="absolute left-0 top-0 w-10 flex justify-center pointer-events-none h-full">
                        <div className="z-10 bg-fcfaf8 p-1 sticky top-6"><Icon type={item.type} /></div>
                    </div>

                    <div className={`glass-card p-5 pr-5 rounded-2xl relative transition-all hover:translate-x-1 active:scale-[0.98]
                        ${item.type === 'transport' ? 'border-l-4 border-l-stone-400 bg-stone-50/60' : 'border-l-4 border-l-momo-pink'}`}>
                        
                        {/* Âãï‰ΩúÊåâÈàï */}
                        <div className="absolute top-2 right-2 flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity bg-white/90 rounded-full p-1 shadow-sm backdrop-blur-sm z-10">
                            <div className="w-8 h-8 flex items-center justify-center text-stone-300 cursor-move" title="ÊãñÊõ≥ÊéíÂ∫è"><svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M4 8h16M4 16h16"></path></svg></div>
                            <a href={`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(item.address || item.name)}`} target="_blank" rel="noopener noreferrer" className="w-8 h-8 rounded-full hover:bg-blue-50 text-stone-400 hover:text-blue-600 flex items-center justify-center" title="Â∞éËà™"><svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"/><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"/></svg></a>
                            <button onClick={() => onDuplicate(index)} className="w-8 h-8 rounded-full hover:bg-green-50 text-stone-400 hover:text-green-600 flex items-center justify-center" title="Ë§áË£Ω"><svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path></svg></button>
                            <button onClick={() => setIsEditing(true)} className="w-8 h-8 rounded-full hover:bg-amber-50 text-stone-400 hover:text-amber-600 flex items-center justify-center" title="Á∑®ËºØ"><svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"></path></svg></button>
                            <button onClick={() => onDelete(index)} className="w-8 h-8 rounded-full hover:bg-red-50 text-stone-400 hover:text-red-600 flex items-center justify-center" title="Âà™Èô§"><svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg></button>
                        </div>

                        <div className="flex justify-between items-start mb-1 pr-2 relative z-0">
                            <span className={`text-xs font-bold px-2 py-0.5 rounded ${item.type === 'transport' ? 'bg-stone-200 text-stone-600' : 'bg-rose-100 text-rose-600'}`}>
                                {item.time}
                            </span>
                            <div className="flex flex-col items-end">
                                {item.jrPass && (
                                    <span className="jr-badge mb-0.5">
                                        <svg className="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M5 13l4 4L19 7"></path></svg>
                                        JR PASS
                                    </span>
                                )}
                                {item.cost > 0 && (
                                    <span className={`text-xs font-mono font-bold ${item.jrPass ? 'text-gray-400 line-through' : 'text-stone-600'}`}>
                                        ¬•{item.cost.toLocaleString()}
                                    </span>
                                )}
                            </div>
                        </div>
                        
                        <h3 className="text-lg font-bold text-stone-800 leading-tight mb-1 pr-12 select-none relative z-0">
                            {item.name}
                        </h3>
                        
                        {item.address && (
                            <p className="text-xs text-stone-400 mb-1 flex items-center gap-1 select-none">
                                üìç {item.address}
                            </p>
                        )}
                        
                        {item.note && (
                            <p className="text-sm text-stone-500 flex items-center gap-1 select-none relative z-0">
                                {item.type === 'transport' ? 'üé´' : 'üí°'} {item.note}
                            </p>
                        )}
                    </div>
                </div>
            );
        };

        const App = () => {
            const [activeDay, setActiveDay] = useState(1);
            const [itinerary, setItinerary] = useState(defaultItineraryData);
            const [loaded, setLoaded] = useState(false);
            const [isPanelExpanded, setIsPanelExpanded] = useState(true);
            
            const dragItem = useRef();
            const dragOverItem = useRef();
            const fileInputRef = useRef(null);

            useEffect(() => {
                const saved = localStorage.getItem('myOkamotoTrip_Clean');
                if (saved) {
                    try { 
                        const parsed = JSON.parse(saved);
                        setItinerary(parsed); 
                    } catch(e) {}
                } else {
                    setItinerary(defaultItineraryData);
                }
                setLoaded(true);
            }, []);

            useEffect(() => {
                if(loaded) localStorage.setItem('myOkamotoTrip_Clean', JSON.stringify(itinerary));
            }, [itinerary, loaded]);

            const currentDayIndex = itinerary.findIndex(d => d.day === activeDay);
            const currentDayData = itinerary[currentDayIndex];

            // Áµ±Ë®à
            const stats = useMemo(() => {
                let totalCash = 0;
                let totalSaved = 0;
                let dailyCash = 0;

                itinerary.forEach(day => {
                    day.locations.forEach(item => {
                        if (item.type === 'transport') {
                            const cost = parseInt(item.cost) || 0;
                            if (item.jrPass) {
                                totalSaved += cost;
                            } else {
                                totalCash += cost;
                                if (day.day === activeDay) {
                                    dailyCash += cost;
                                }
                            }
                        }
                    });
                });

                return { totalCash, totalSaved, dailyCash };
            }, [itinerary, activeDay]);

            // CRUD Handlers
            const updateLocations = (newLocations) => {
                const newItinerary = [...itinerary];
                newItinerary[currentDayIndex] = { ...currentDayData, locations: newLocations };
                setItinerary(newItinerary);
            };
            const handleUpdateItem = (idx, item) => {
                const newLocs = [...currentDayData.locations];
                newLocs[idx] = item;
                updateLocations(newLocs);
            };
            const handleDeleteItem = (idx) => {
                const newLocs = currentDayData.locations.filter((_, i) => i !== idx);
                updateLocations(newLocs);
            };
            const handleDuplicateItem = (idx) => {
                const item = { ...currentDayData.locations[idx], id: Date.now() };
                const newLocs = [...currentDayData.locations];
                newLocs.splice(idx + 1, 0, item);
                updateLocations(newLocs);
            };
            const handleAddItem = () => {
                const newName = "Êñ∞Ë°åÁ®ã";
                updateLocations([...currentDayData.locations, { 
                    id: Date.now(), time: "ÊôÇÈñì", name: newName, address: "", type: "activity", cost: 0, jrPass: false, note: ""
                }]);
            };

            // Ê™îÊ°àÂåØÂá∫ (‰∏ãËºâ/ÂÑ≤Â≠ò)
            const handleExport = async () => {
                const dataStr = JSON.stringify(itinerary, null, 2);
                
                if ('showSaveFilePicker' in window) {
                    try {
                        const handle = await window.showSaveFilePicker({
                            suggestedName: `okayama_trip_${new Date().toISOString().slice(0,10)}.json`,
                            types: [{
                                description: 'JSON Files',
                                accept: { 'application/json': ['.json'] },
                            }],
                        });
                        const writable = await handle.createWritable();
                        await writable.write(dataStr);
                        await writable.close();
                        alert("Ê™îÊ°àÂÑ≤Â≠òÊàêÂäüÔºÅ");
                        return;
                    } catch (err) {
                        if (err.name !== 'AbortError') console.error('SaveFilePicker failed:', err);
                        else return;
                    }
                }

                const blob = new Blob([dataStr], { type: "application/json" });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `okayama_trip_${new Date().toISOString().slice(0,10)}.json`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            };

            // Ê™îÊ°àÂåØÂÖ• (ËÆÄÂèñ)
            const handleImportClick = () => {
                fileInputRef.current.click();
            };

            const handleFileChange = (e) => {
                const file = e.target.files[0];
                if (!file) return;
                const reader = new FileReader();
                reader.onload = (event) => {
                    try {
                        const parsed = JSON.parse(event.target.result);
                        if (Array.isArray(parsed) && parsed.length > 0 && parsed[0].locations) {
                            if(confirm("Á¢∫ÂÆöË¶ÅËÆÄÂèñÊ≠§Ê™îÊ°àÂóéÔºüÁõÆÂâçÁöÑË°åÁ®ãÂ∞áË¢´Ë¶ÜËìã„ÄÇ")) {
                                setItinerary(parsed);
                                alert("Ë°åÁ®ãËÆÄÂèñÊàêÂäüÔºÅ");
                            }
                        } else {
                            alert("Ê™îÊ°àÊ†ºÂºè‰∏çÊ≠£Á¢∫ÔºåË´ãÁ¢∫Ë™çÈÄôÊòØÊú¨Á≥ªÁµ±ÂåØÂá∫ÁöÑ JSON Ê™î„ÄÇ");
                        }
                    } catch (err) {
                        alert("ÁÑ°Ê≥ïËÆÄÂèñÊ™îÊ°àÔºåË´ãÁ¢∫Ë™çÊ™îÊ°àÊ†ºÂºè„ÄÇ");
                    }
                    e.target.value = null; // Reset input
                };
                reader.readAsText(file);
            };

            // Drag & Drop
            const handleDragStart = (e, position) => {
                dragItem.current = position;
                e.target.classList.add('dragging');
            };
            const handleDragEnter = (e, position) => {
                dragOverItem.current = position;
                if (dragItem.current !== null && dragItem.current !== position) {
                    const copyListItems = [...currentDayData.locations];
                    const dragItemContent = copyListItems[dragItem.current];
                    copyListItems.splice(dragItem.current, 1);
                    copyListItems.splice(position, 0, dragItemContent);
                    dragItem.current = position;
                    updateLocations(copyListItems);
                }
            };
            const handleDragEnd = (e) => {
                dragItem.current = null;
                dragOverItem.current = null;
                e.target.classList.remove('dragging');
            };

            if (!loaded) return null;

            return (
                <div className="min-h-screen pb-40 relative">
                    <header className="bg-stone-900 text-white py-8 px-6 text-center relative overflow-hidden flex flex-col items-center">
                        <div className="absolute inset-0 opacity-10" style={{backgroundImage: "radial-gradient(#ffffff 1px, transparent 1px)", backgroundSize: "20px 20px"}}></div>
                        <div className="relative z-10 w-full max-w-4xl flex justify-between items-start mb-4">
                             {/* Ê®ôÈ°åÂçÄ */}
                            <div className="text-left">
                                <h1 className="text-2xl md:text-3xl font-serif font-bold text-momo-pink mb-1">Â≤°Â±±Ê°ÉÂ§™ÈÉé‰πãÊóÖ</h1>
                                <p className="text-stone-400 text-xs tracking-widest">SIMPLE CLEAN EDITION</p>
                            </div>

                            {/* ÂäüËÉΩÊåâÈàïÂçÄ */}
                            <div className="flex gap-2">
                                <button onClick={handleExport} className="flex items-center gap-1 bg-stone-700 hover:bg-stone-600 px-3 py-1.5 rounded-lg text-xs transition-colors" title="ÂåØÂá∫Ë°åÁ®ã (‰∏ãËºâ)">
                                    <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path></svg>
                                    <span className="hidden md:inline">ÂåØÂá∫</span>
                                </button>
                                <button onClick={handleImportClick} className="flex items-center gap-1 bg-stone-700 hover:bg-stone-600 px-3 py-1.5 rounded-lg text-xs transition-colors" title="ÂåØÂÖ•Ë°åÁ®ã (ËÆÄÂèñ)">
                                    <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"></path></svg>
                                    <span className="hidden md:inline">ÂåØÂÖ•</span>
                                </button>
                                <input type="file" ref={fileInputRef} onChange={handleFileChange} accept=".json" className="hidden" />
                                
                                <button onClick={() => {if(window.confirm("ÈáçÁΩÆÂ∞áÊ∏ÖÈô§ÊâÄÊúâ‰øÆÊîπÔºü")) { localStorage.removeItem('myOkamotoTrip_Clean'); window.location.reload(); }}} 
                                    className="flex items-center gap-1 bg-stone-800 hover:bg-red-900/50 text-stone-400 hover:text-red-300 px-3 py-1.5 rounded-lg text-xs transition-colors" title="ÈáçÁΩÆ">
                                    <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path></svg>
                                </button>
                            </div>
                        </div>
                    </header>

                    <div className="max-w-3xl mx-auto px-4 mt-6">
                        <div className="flex gap-2 overflow-x-auto pb-4 scrollbar-hide sticky top-2 z-30 py-2 bg-gradient-to-b from-[#fcfaf8] to-transparent">
                            {itinerary.map((data) => (
                                <button key={data.day} onClick={() => setActiveDay(data.day)}
                                    className={`px-4 py-2 rounded-full text-sm font-bold whitespace-nowrap transition-all shadow-sm
                                        ${activeDay === data.day ? 'bg-stone-800 text-white transform scale-105' : 'bg-white text-stone-400 border border-stone-200'}`}>
                                    Day {data.day}
                                </button>
                            ))}
                        </div>

                        <div key={activeDay} className="fade-in mt-2 pb-12">
                            <div className="mb-6 px-2">
                                <h2 className="text-2xl font-serif font-bold text-stone-800 flex items-center gap-2">
                                    <span className="text-momo-red">Day {currentDayData.day}</span>
                                    {currentDayData.title}
                                </h2>
                                <p className="text-stone-500 text-sm mt-1 ml-1">{currentDayData.subtitle}</p>
                            </div>

                            <div className="space-y-4 relative pl-2">
                                <div className="absolute left-7 top-4 bottom-4 w-0.5 bg-stone-200"></div>
                                {currentDayData.locations.map((item, index) => (
                                    <LocationCard 
                                        key={item.id} item={item} index={index}
                                        isLast={index === currentDayData.locations.length - 1}
                                        onUpdate={handleUpdateItem} onDelete={handleDeleteItem} 
                                        onDuplicate={handleDuplicateItem}
                                        onDragStart={handleDragStart} onDragEnter={handleDragEnter} onDragEnd={handleDragEnd}
                                    />
                                ))}
                                <button onClick={handleAddItem} className="ml-14 w-[calc(100%-3.5rem)] py-3 border-2 border-dashed border-stone-300 rounded-xl text-stone-400 hover:border-momo-pink hover:text-momo-red hover:bg-rose-50 transition-colors font-bold text-sm">
                                    + Êñ∞Â¢ûË°åÁ®ã
                                </button>
                            </div>
                        </div>
                    </div>

                    {/* Êá∏ÊµÆË≤ªÁî®Áµ±Ë®àÈù¢Êùø (ÂèØÊî∂Á¥ç) */}
                    <div className={`fixed bottom-6 right-4 left-4 md:left-auto md:w-80 cost-panel rounded-2xl transition-all duration-300 z-40 overflow-hidden ${isPanelExpanded ? 'p-4' : 'p-3'}`}>
                        <div 
                            className="flex justify-between items-center cursor-pointer"
                            onClick={() => setIsPanelExpanded(!isPanelExpanded)}
                        >
                            <div className="flex items-center gap-2">
                                <span className="text-stone-300 text-xs uppercase tracking-wider font-bold">
                                    {isPanelExpanded ? "Ë≤ªÁî®Áµ±Ë®à" : "Total Payment"}
                                </span>
                                {!isPanelExpanded && (
                                    <span className="text-momo-pink font-mono font-bold">
                                        ¬•{stats.totalCash.toLocaleString()}
                                    </span>
                                )}
                            </div>
                            
                            <button className="text-stone-400 hover:text-white transition-colors">
                                <svg 
                                    className={`w-5 h-5 transform transition-transform ${isPanelExpanded ? 'rotate-180' : ''}`} 
                                    fill="none" stroke="currentColor" viewBox="0 0 24 24"
                                >
                                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M19 9l-7 7-7-7" />
                                </svg>
                            </button>
                        </div>

                        {isPanelExpanded && (
                            <div className="mt-3 pt-3 border-t border-white/10 flex flex-col gap-2 fade-in">
                                 <div className="flex justify-between items-center">
                                    <span className="text-gray-300 text-sm">Êú¨Êó•Ëá™‰ªò‰∫§ÈÄöË≤ª</span>
                                    <span className="text-lg font-mono font-bold text-white">¬•{stats.dailyCash.toLocaleString()}</span>
                                </div>
                                <div className="grid grid-cols-2 gap-4 pt-1">
                                    <div>
                                        <p className="text-[10px] text-gray-400 uppercase tracking-wider">Total Payment</p>
                                        <p className="text-xl font-mono font-bold text-momo-pink">¬•{stats.totalCash.toLocaleString()}</p>
                                    </div>
                                    <div className="text-right">
                                        <p className="text-[10px] text-gray-400 uppercase tracking-wider">JR Pass Saved</p>
                                        <p className="text-xl font-mono font-bold text-green-400">¬•{stats.totalSaved.toLocaleString()}</p>
                                    </div>
                                </div>
                                {stats.totalSaved > 23000 && (
                                    <div className="text-center text-[10px] text-green-300 bg-green-900/30 rounded py-1 animate-pulse mt-1">
                                        ‚ú® ÊÅ≠ÂñúÔºÅJR Pass Â∑≤ÂõûÊú¨ (Á•®ÂÉπ ¬•23,000)
                                    </div>
                                )}
                            </div>
                        )}
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>